<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dev's Reality Eraser Miracle</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; display: flex; justify-content: center; align-items: center; height: 100vh; }
        
        /* કન્ટેનર જ્યાં બધું એકબીજા પર ગોઠવાશે */
        #canvas-container {
            position: relative;
            width: 640px; height: 480px;
            border: 3px solid #00d2ff;
            box-shadow: 0 0 30px #00d2ff;
            border-radius: 10px; overflow: hidden;
        }

        /* લેયર 1: છુપાયેલી દુનિયા (સૌથી નીચે) */
        #hidden-reality {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            /* અહીં એક સરસ ગેલેક્સીનો ફોટો મૂક્યો છે */
            background: url('https://images.unsplash.com/photo-1462331940025-496dfa712568?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80') no-repeat center center;
            background-size: cover;
            z-index: 1;
        }

        /* લેયર 2: જેના પર આપણે ડ્રો કરીશું (માસ્ક) */
        #drawing-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 2; transform: scaleX(-1); /* મિરર ઈફેક્ટ માટે */
        }

        /* કેમેરા (છુપાયેલો) */
        #webcam { display: none; }
        
        #loading { position: absolute; color: #00d2ff; font-family: sans-serif; z-index: 10; text-shadow: 0 0 10px #00d2ff;}
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
</head>
<body>

    <div id="loading">Preparing Miracle... (Wait 10s)</div>

    <div id="canvas-container">
        <div id="hidden-reality"></div>
        <canvas id="drawing-canvas"></canvas>
    </div>

    <video id="webcam" playsinline></video>

    <script>
        const videoElement = document.getElementById('webcam');
        const canvas = document.getElementById('drawing-canvas');
        const ctx = canvas.getContext('2d', { willReadFrequently: true });
        const loading = document.getElementById('loading');

        canvas.width = 640;
        canvas.height = 480;

        let fingerX = null, fingerY = null;

        function onResults(results) {
            loading.style.display = 'none';

            // 1. પહેલા આખો કેમેરા ફીડ દોરો (સામાન્ય રીતે)
            ctx.globalCompositeOperation = 'source-over';
            ctx.drawImage(results.image, 0, 0, canvas.width, canvas.height);

            // 2. જો આંગળી દેખાય...
            if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
                const landmarks = results.multiHandLandmarks[0];
                // Index Finger Tip (8)
                const indexTip = landmarks[8];
                
                // કો-ઓર્ડિનેટ્સ
                const x = indexTip.x * canvas.width;
                const y = indexTip.y * canvas.height;

                // 3. ચમત્કારિક ભાગ: "ભૂંસવાનું" સેટિંગ
                // 'destination-out' મતલબ: જ્યાં ડ્રો કરશો ત્યાં પારદર્શક બની જશે
                ctx.globalCompositeOperation = 'destination-out';

                // આંગળીની જગ્યાએ મોટું વર્તુળ દોરો (જે ભૂંસી નાખશે)
                ctx.beginPath();
                ctx.arc(x, y, 40, 0, 2 * Math.PI); // 40 એ બ્રશની સાઈઝ છે
                ctx.fillStyle = "rgba(0,0,0,1)";
                ctx.fill();
                
                // જો તમારે લીટો દોરવો હોય (Eraser Trail) તો આ કોમેન્ટ ખોલો:
                /*
                if (fingerX !== null) {
                    ctx.beginPath();
                    ctx.moveTo(fingerX, fingerY);
                    ctx.lineTo(x, y);
                    ctx.lineWidth = 80;
                    ctx.lineCap = 'round';
                    ctx.stroke();
                }
                fingerX = x; fingerY = y;
                */
            } else {
                fingerX = null; fingerY = null;
            }
            // નોંધ: આ કોડમાં આપણે દર ફ્રેમમાં કેન્વાસ ક્લીયર નથી કરતા, 
            // જેથી "ભૂંસાયેલો" ભાગ એમ ને એમ રહે.
        }

        const hands = new Hands({locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`});
        hands.setOptions({
            maxNumHands: 1,
            modelComplexity: 1,
            minDetectionConfidence: 0.7,
            minTrackingConfidence: 0.7
        });
        hands.onResults(onResults);

        const camera = new Camera(videoElement, {
            onFrame: async () => await hands.send({image: videoElement}),
            width: 640, height: 480
        });
        camera.start();
    </script>
</body>
</html>
