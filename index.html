<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dev's Genesis: Artificial Life</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Courier New', monospace; }
        canvas { display: block; }
        
        #gui {
            position: absolute; top: 10px; right: 10px;
            background: rgba(0, 0, 0, 0.8); padding: 15px;
            border: 1px solid #444; color: #fff; width: 250px;
            border-radius: 8px;
        }
        
        button {
            width: 100%; padding: 10px; margin-top: 10px;
            background: #222; color: #0f0; border: 1px solid #0f0;
            cursor: pointer; font-weight: bold;
        }
        button:hover { background: #0f0; color: #000; }
        
        .stat { font-size: 12px; color: #aaa; margin-bottom: 5px; }
    </style>
</head>
<body>

    <div id="gui">
        <h3 style="margin:0 0 10px 0; color:#0f0;">GENESIS ENGINE</h3>
        <div class="stat">ATOMS: <span id="atom-count">0</span></div>
        <div class="stat">FPS: <span id="fps">0</span></div>
        <div style="font-size:10px; color:#888; margin-top:5px;">
            નિયમ: કલર એકબીજાને આકર્ષે કે અપાકર્ષે છે. તેમાંથી "જીવન" આપોઆપ બનશે.
        </div>
        <button onclick="randomizeRules()">RESET UNIVERSE</button>
    </div>

    <canvas id="life"></canvas>

    <script>
        const canvas = document.getElementById('life');
        const ctx = canvas.getContext('2d');
        
        // સેટિંગ્સ
        const atomSize = 2; // અણુનું કદ
        let atoms = [];
        
        // બ્રહ્માંડના રંગો (તત્વો)
        const colors = ['#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#00FFFF', '#FF00FF'];
        // નિયમોનો મેટ્રિક્સ (કોણ કોને આકર્ષે છે)
        let rules = []; 

        // કેન્વાસ સાઈઝ
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // અણુ ક્લાસ
        const createAtom = (x, y, colorIdx) => {
            return {
                x: x, y: y,
                vx: 0, vy: 0, // વેગ (Velocity)
                color: colorIdx
            };
        };

        // રેન્ડમ પોઝિશન
        const randomX = () => Math.random() * canvas.width;
        const randomY = () => Math.random() * canvas.height;

        // બ્રહ્માંડ બનાવો
        const createUniverse = (numberPerColor) => {
            atoms = [];
            for (let c = 0; c < colors.length; c++) {
                for (let i = 0; i < numberPerColor; i++) {
                    atoms.push(createAtom(randomX(), randomY(), c));
                }
            }
            document.getElementById('atom-count').innerText = atoms.length;
        };

        // નિયમો બનાવો (ગુરુત્વાકર્ષણ/અપાકર્ષણ)
        const randomizeRules = () => {
            rules = [];
            for (let i = 0; i < colors.length; i++) {
                rules[i] = [];
                for (let j = 0; j < colors.length; j++) {
                    // -1 (Strong Repel) થી +1 (Strong Attract)
                    rules[i][j] = (Math.random() * 2) - 1;
                }
            }
            // ફરીથી શરૂ કરો
            createUniverse(300); // દરેક કલરના ૩૦૦ અણુ (કુલ ૧૮૦૦)
        };

        // ભૌતિક વિજ્ઞાનનું હૃદય (Physics Engine)
        const applyRules = () => {
            for (let i = 0; i < atoms.length; i++) {
                let fx = 0;
                let fy = 0;
                const a = atoms[i];

                for (let j = 0; j < atoms.length; j++) {
                    if (i === j) continue; // પોતાની સાથે નહીં
                    
                    const b = atoms[j];
                    
                    // નિયમ: a કલર b કલર સાથે કેવી વર્તણૂક કરશે?
                    const g = rules[a.color][b.color]; 
                    
                    // જો g શૂન્યની નજીક હોય, તો ગણતરી છોડી દો (ઓપ્ટિમાઈઝેશન)
                    if (Math.abs(g) < 0.05) continue;

                    let dx = a.x - b.x;
                    let dy = a.y - b.y;
                    
                    // Infinite World Logic (સ્ક્રીનની બીજી બાજુથી નીકળે)
                    if (dx > canvas.width * 0.5) dx -= canvas.width;
                    if (dx < -canvas.width * 0.5) dx += canvas.width;
                    if (dy > canvas.height * 0.5) dy -= canvas.height;
                    if (dy < -canvas.height * 0.5) dy += canvas.height;

                    const d = Math.sqrt(dx*dx + dy*dy);

                    if (d > 0 && d < 80) { // 80 પિક્સેલની ત્રિજ્યામાં જ અસર કરે
                        // બળ (Force) ફોર્મ્યુલા
                        // F = G * 1/d
                        const F = (g * 1) / d;
                        fx += (F * dx);
                        fy += (F * dy);
                    }
                }

                // વેગ અપડેટ (Viscosity/Friction સાથે)
                a.vx = (a.vx + fx) * 0.5;
                a.vy = (a.vy + fy) * 0.5;

                // પોઝિશન અપડેટ
                a.x += a.vx;
                a.y += a.vy;

                // બાઉન્ડ્રી (દીવાલ સાથે અથડાઈને પાછા આવે)
                if (a.x <= 0 || a.x >= canvas.width) a.vx *= -1;
                if (a.y <= 0 || a.y >= canvas.height) a.vy *= -1;
                
                // ખાતરી કરો કે બહાર ન જાય
                if (a.x < 0) a.x = 0;
                if (a.x > canvas.width) a.x = canvas.width;
                if (a.y < 0) a.y = 0;
                if (a.y > canvas.height) a.y = canvas.height;
            }
        };

        // રેન્ડર લૂપ
        let lastTime = 0;
        const update = (time) => {
            // FPS ગણતરી
            const fps = Math.round(1000 / (time - lastTime));
            lastTime = time;
            if (time % 10 === 0) document.getElementById('fps').innerText = fps; // ક્યારેક અપડેટ કરો

            // ગણતરી
            applyRules();

            // ડ્રોઈંગ
            ctx.fillStyle = "black";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            for (let i = 0; i < atoms.length; i++) {
                const a = atoms[i];
                ctx.fillStyle = colors[a.color];
                ctx.fillRect(a.x, a.y, atomSize, atomSize);
            }

            requestAnimationFrame(update);
        };

        // શરૂઆત
        randomizeRules();
        requestAnimationFrame(update);

    </script>
</body>
</html>
