<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Next Level Mentalist</title>
    <style>
        body { margin: 0; background: #0f0c29; color: white; font-family: sans-serif; overflow: hidden; }
        h2 { text-align: center; margin-top: 10px; color: #00d2ff; text-shadow: 0 0 10px #00d2ff; }
        
        #webcam { position: absolute; top: 0; left: 0; width: 100px; opacity: 0.3; transform: scaleX(-1); }
        
        /* рк╕рлНркорк╛рк░рлНркЯ ркХрк░рлНрк╕рк░ */
        #magicCursor {
            position: absolute; width: 25px; height: 25px;
            border: 3px solid #00d2ff; border-radius: 50%;
            pointer-events: none; display: none; z-index: 100;
            transition: background 0.1s, transform 0.1s;
            transform: translate(-50%, -50%);
        }

        /* ркЬрлНркпрк╛рк░рлЗ рккрк┐ркВркЪ ркХрк░рлЛ ркдрлНркпрк╛рк░рлЗ ркХрк░рлНрк╕рк░ ркЖрк╡рлБркВ ркерк╢рлЗ */
        #magicCursor.clicking {
            background: #00d2ff;
            transform: translate(-50%, -50%) scale(0.8);
        }

        .card-container {
            display: flex; justify-content: center; align-items: center;
            height: 80vh; gap: 20px;
        }

        .card {
            width: 100px; height: 160px;
            background: linear-gradient(135deg, #2b2b2b, #000);
            border: 2px solid #555; border-radius: 12px;
            display: flex; justify-content: center; align-items: center;
            font-size: 50px; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            transition: transform 0.3s, border-color 0.3s;
        }

        /* ркЬрлЗ рк╕рк┐рк▓рлЗркХрлНркЯ ркерк╛ркп ркП ркХрк╛рк░рлНркб ркЧрлНрк▓рлЛ ркерк╢рлЗ */
        .card.active { border-color: #00d2ff; transform: scale(1.1); box-shadow: 0 0 25px #00d2ff; }
        .card span { display: none; filter: drop-shadow(0 0 5px white); }
        .card.revealed { background: white; }
        .card.revealed span { display: block; }

        .instruction {
            position: absolute; bottom: 20px; width: 100%; text-align: center;
            color: gray; font-size: 14px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
</head>
<body>

    <h2>Gesture Master ЁЯдП</h2>
    
    <video id="webcam" playsinline></video>
    <div id="magicCursor"></div>

    <div class="card-container">
        <div class="card" id="c1"><span>ЁЯХЙя╕П</span></div>
        <div class="card" id="c2"><span>тЪЫя╕П</span></div>
        <div class="card" id="c3"><span>тШпя╕П</span></div>
    </div>

    <div class="instruction">ркХрк╛рк░рлНркб рккрк░ ркЖркВркЧрк│рлА рк▓рк╛рк╡рлЛ ркЕркирлЗ рккрк╕ркВркж ркХрк░рк╡рк╛ ркорк╛ркЯрлЗ <b>ркЪрккркЯрлА (Pinch)</b> рк╡ркЧрк╛ркбрлЛ ЁЯСМ</div>

    <script>
        const videoElement = document.getElementById('webcam');
        const cursor = document.getElementById('magicCursor');
        const cards = document.querySelectorAll('.card');
        
        // ркХрлНрк▓рк┐ркХ рк╕рк╛ркЙркирлНркб ркИрклрлЗркХрлНркЯ (ркУрккрлНрк╢ркирк▓)
        // const clickSound = new Audio('https://www.soundjay.com/button/sounds/button-3.mp3'); 

        function onResults(results) {
            if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
                const landmarks = results.multiHandLandmarks[0];
                
                // Point 8 = Index Finger Tip (ркЖркВркЧрк│рлА)
                // Point 4 = Thumb Tip (ркЕркВркЧрлВркарлЛ)
                const indexTip = landmarks[8];
                const thumbTip = landmarks[4];

                // ркХрк░рлНрк╕рк░ркирлА рккрлЛркЭрк┐рк╢рки (ркЖркВркЧрк│рлАркирк╛ ркЯрлЗрк░рк╡рлЗ)
                const x = (1 - indexTip.x) * window.innerWidth;
                const y = indexTip.y * window.innerHeight;
                
                cursor.style.left = x + "px";
                cursor.style.top = y + "px";
                cursor.style.display = "block";

                // ркЧркгрк┐ркд: ркмрлЗ рккрлЛркИркирлНркЯ рк╡ркЪрлНркЪрлЗркирлБркВ ркЕркВркдрк░ (Pythagorean theorem)
                // ркЖ ркиркХрлНркХрлА ркХрк░рк╢рлЗ ркХрлЗ ркдркорлЗ ркЪрккркЯрлА рк╡ркЧрк╛ркбрлА ркЫрлЗ ркХрлЗ ркирк╣рлАркВ
                const distance = Math.hypot(
                    (indexTip.x - thumbTip.x),
                    (indexTip.y - thumbTip.y)
                );

                // ркЬрлЛ ркЕркВркдрк░ 0.05 ркерлА ркУркЫрлБркВ рк╣рлЛркп, ркдрлЛ ркдрлЗркирлЗ "CLICK" ркЧркгрк╡рлБркВ
                const isPinching = distance < 0.05;

                if (isPinching) {
                    cursor.classList.add('clicking');
                } else {
                    cursor.classList.remove('clicking');
                }

                // ркХрк╛рк░рлНркбрлНрк╕ рк╕рк╛ркерлЗ ркЕркеркбрк╛ркоркг (Collision Detection)
                cards.forEach(card => {
                    const rect = card.getBoundingClientRect();
                    
                    if (x > rect.left && x < rect.right && y > rect.top && y < rect.bottom) {
                        card.classList.add('active'); // ркЧрлНрк▓рлЛ ркИрклрлЗркХрлНркЯ
                        
                        // ркЬрлЛ ркХрк╛рк░рлНркб ркЙрккрк░ рк╣рлЛрк╡ ркЕркирлЗ рккрк┐ркВркЪ (Click) ркХрк░рлЛ ркдрлЛ ркЬ ркЦрлВрк▓рлЗ
                        if (isPinching && !card.classList.contains('revealed')) {
                            // clickSound.play(); // рк╕рк╛ркЙркирлНркб
                            card.classList.add('revealed');
                            
                            // рклрлЛрки рк╡рк╛ркИркмрлНрк░рлЗркЯ ркерк╢рлЗ (Tactile Feedback)
                            if (navigator.vibrate) navigator.vibrate(50);
                        }
                    } else {
                        card.classList.remove('active');
                    }
                });

            } else {
                cursor.style.display = "none";
            }
        }

        const hands = new Hands({locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`});
        
        hands.setOptions({
            maxNumHands: 1,
            modelComplexity: 1,
            minDetectionConfidence: 0.7,
            minTrackingConfidence: 0.7
        });

        hands.onResults(onResults);

        const camera = new Camera(videoElement, {
            onFrame: async () => await hands.send({image: videoElement}),
            width: 640, height: 480
        });
        camera.start();
    </script>
</body>
</html>
